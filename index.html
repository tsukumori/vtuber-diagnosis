<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>VTuberè¨ºæ–­</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 40px;
    }
    button {
      padding: 10px 16px;
      margin: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    #question {
      font-size: 20px;
      margin-bottom: 20px;
    }
    #result {
      margin-top: 30px;
      font-size: 22px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>VTuberã‚¿ã‚¤ãƒ—è¨ºæ–­</h1>

<div id="inputArea">
  <h2>ã¾ãšã¯æ•™ãˆã¦ã­</h2>

  <p>
    æ´»å‹•åï¼ˆå¿…é ˆï¼‰<br>
    <input type="text" id="name" placeholder="ä¾‹ï¼šã­ã“ã¾ã‚‹">
  </p>

  <p>
    SNSï¼ˆä»»æ„ï¼‰<br>
    <input type="text" id="sns" placeholder="X / YouTube ã®URLãªã©">
  </p>

  <button onclick="startDiagnosis()">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
</div>

<div id="diagnosisArea" style="display:none;">
  <div id="question"></div>
  <div id="buttons"></div>
  <div id="result"></div>
</div>

<script>
/* ========= å…¥åŠ›å€¤ ========= */
let userName = "";
let userSNS = "";

/* ========= è¨ºæ–­é–‹å§‹ ========= */
function startDiagnosis() {
  const nameInput = document.getElementById("name").value;

  if (!nameInput) {
    alert("æ´»å‹•åã‚’å…¥åŠ›ã—ã¦ã­ï¼");
    return;
  }

  userName = nameInput;
  userSNS = document.getElementById("sns").value;

  document.getElementById("inputArea").style.display = "none";
  document.getElementById("diagnosisArea").style.display = "block";

  showQuestion();
}

/* ========= è³ªå• ========= */
const questions = [
  { text: "ä¸€äººã§ä½œæ¥­ã™ã‚‹æ–¹ãŒè½ã¡ç€ã", axis: "A" },
  { text: "é…ä¿¡ã¯å‹¢ã„ãŒå¤§äº‹ã ã¨æ€ã†", axis: "B" },
  { text: "é•·æ™‚é–“é…ä¿¡ã¯è‹¦ã˜ã‚ƒãªã„", axis: "C" },
  { text: "è¨ˆç”»ã‚’ç«‹ã¦ã‚‹ã®ãŒå¾—æ„", axis: "D" },
  { text: "é›‘è«‡ã¯å³èˆˆã§è©±ã™ã“ã¨ãŒå¤šã„", axis: "B" },
  { text: "æ¯å›ã ã„ãŸã„åŒã˜æ™‚é–“ã«é…ä¿¡ã—ãŸã„", axis: "D" }
];

const results = {
  "0000": "æŠ¼ã—èŠ±ã®æ ",
  "0001": "ä¸‡å¹´ç­†",
  "0010": "é‡£ã‚Š",
  "0011": "ç ‚æ™‚è¨ˆ",
  "0100": "ã‚¬ãƒ©ã‚¹ãƒšãƒ³",
  "0101": "å‰£",
  "0110": "ä¸‡è¯é¡",
  "0111": "æ–‡å­—ãŒæµã‚Œã‚‹å°æœ¬ãƒãƒ¼ãƒˆ",
  "1000": "åœ°çƒå„€",
  "1001": "ç„¡é™ãƒ„ãƒƒã‚³ãƒŸãƒãƒªã‚»ãƒ³",
  "1010": "çœŸé¢ç›®ã•ã‚“ã®çŸ¥æ€§ãƒ¡ã‚¬ãƒ",
  "1011": "ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆä»˜ãè…•æ™‚è¨ˆ",
  "1100": "ã·ã‚Šã·ã‚Šã‚­ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼çŒ«è€³",
  "1101": "ãƒ‰æ´¾æ‰‹ã‚¯ãƒ©ãƒƒã‚«ãƒ¼",
  "1110": "ãµã‚ãµã‚å¤©ä½¿ã®ç¾½",
  "1111": "å†’é™ºåœ°å›³"
};

let current = 0;
let scores = { A: 0, B: 0, C: 0, D: 0 };

const scale = [
  { label: "ã‹ãªã‚Šã‚ã¦ã¯ã¾ã‚‹", value: 2 },
  { label: "ã‚„ã‚„ã‚ã¦ã¯ã¾ã‚‹", value: 1 },
  { label: "ã©ã¡ã‚‰ã§ã‚‚ãªã„", value: 0 },
  { label: "ã‚„ã‚„ã‚ã¦ã¯ã¾ã‚‰ãªã„", value: -1 },
  { label: "å…¨ãã‚ã¦ã¯ã¾ã‚‰ãªã„", value: -2 }
];

function showQuestion() {
  const q = questions[current];
  document.getElementById("question").textContent =
    `Q${current + 1}. ${q.text}`;

  const buttons = document.getElementById("buttons");
  buttons.innerHTML = "";

  scale.forEach(s => {
    const btn = document.createElement("button");
    btn.textContent = s.label;
    btn.onclick = () => answer(s.value);
    buttons.appendChild(btn);
  });
}

function answer(value) {
  const axis = questions[current].axis;
  scores[axis] += value;
  current++;

  if (current < questions.length) {
    showQuestion();
  } else {
    showResult();
  }
}

/* ========= çµæœè¡¨ç¤º ========= */
function showResult() {
  document.getElementById("question").style.display = "none";
  document.getElementById("buttons").style.display = "none";

  let key = "";
  let closeAxes = 0;

  ["A", "B", "C", "D"].forEach(axis => {
    if (Math.abs(scores[axis]) <= 1) closeAxes++;
    key += scores[axis] >= 0 ? "0" : "1";
  });

  const result =
    closeAxes >= 3
      ? "ğŸŒˆ è™¹è‰²ãƒã‚¤ã‚¯ï¼ˆä¸‡èƒ½ãƒãƒ©ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ï¼‰"
      : results[key];

  document.getElementById("result").textContent =
    `${userName}ã•ã‚“ã®è¨ºæ–­çµæœã¯ã€Œ${result}ã€ã§ã™ï¼`;

  sendToGoogleForm(result);
}

/* ========= Googleãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ ========= */
function sendToGoogleForm(result) {
  const formURL =
    "https://docs.google.com/forms/d/e/1FAIpQLSeImoVfM8wsLUi4aGz1tcqxeHvzNd9EGf3Lp926IHsy03L3VQ/formResponse";

  const data = new FormData();

  data.append("entry.2016327248", userName); // æ´»å‹•å
  data.append("entry.363261105", userSNS);   // SNS
  data.append("entry.429828253", result);    // è¨ºæ–­çµæœ
  data.append("entry.1683531211", scores.A);
  data.append("entry.1818111503", scores.B);
  data.append("entry.772384761", scores.C);
  data.append("entry.1265151043", scores.D);

  fetch(formURL, {
    method: "POST",
    mode: "no-cors",
    body: data
  });
}
</script>

</body>
</html>
