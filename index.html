<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VTuberã‚¿ã‚¤ãƒ—è¨ºæ–­</title>
<style>
body {
  font-family: sans-serif;
  text-align: center;
  padding: clamp(20px, 6vw, 40px);
  font-size: clamp(16px, 4.5vw, 18px);
}

h1 {
  font-size: clamp(22px, 6vw, 28px);
}

input {
  font-size: clamp(16px, 4.5vw, 18px);
  padding: 10px;
  width: min(90%, 320px);
}

button {
  padding: 14px 20px;
  margin: 10px;
  font-size: clamp(16px, 4.5vw, 18px);
  min-width: min(90%, 280px);
  cursor: pointer;
  border-radius: 8px;
  border: none;
}

.backButton {
  background: #666;
  color: #fff;
  border: none;
  border-radius: 8px;
}

#question {
  font-size: clamp(18px, 5.5vw, 22px);
  margin-bottom: 24px;
}

#progress {
  margin-top: 16px;
  font-size: 14px;
  opacity: 0.8;
}

#result {
  font-size: clamp(20px, 6vw, 24px);
  font-weight: bold;
  margin-top: 24px;
}

/* ===== ã‚¹ãƒãƒ›å°‚ç”¨èª¿æ•´ ===== */
@media (max-width: 480px) {
  body { font-size: 18px; }
  h1 { font-size: 26px; }
  input { font-size: 18px; padding: 14px; }
  button { font-size: 18px; padding: 16px 20px; }
  #question { font-size: 22px; }
  #result { font-size: 24px; }
  #resultImage img { max-width: 100%; }
}
</style>
</head>
<body>

<h1>VTuberã‚¿ã‚¤ãƒ—è¨ºæ–­ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰</h1>

<div id="inputArea">
  <p>å…¨12å•ãƒ»æ‰€è¦æ™‚é–“ ç´„2åˆ†</p>
  <p>
    ãŠåå‰ï¼ˆä»»æ„ï¼‰<br>
    <input id="nameInput">
  </p>

  <button onclick="startDiagnosis()">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
</div>

<div id="diagnosisArea" style="display:none;">
  <div id="question"></div>
  <div id="buttons"></div>
  <div id="progress"></div>
  <button class="backButton" onclick="goBack()">â† æˆ»ã‚‹</button>
</div>

<div id="resultArea" style="display:none;">
  <div id="result"></div>
  <div id="resultImage"></div>
  <button id="shareBtn">Xã§å…±æœ‰</button>
</div>

<script>
/* =====================
   çµæœï¼ˆ16ã‚¿ã‚¤ãƒ—ï¼‰
===================== */
/**
 * ã‚¹ã‚³ã‚¢ã®å‘ãï¼ˆãƒ—ãƒ©ã‚¹å´ï¼‰ï¼š
 * A: å­¤ç‹¬ / B: ãƒ‡ãƒ¼ã‚¿ / C: çŸ­æ™‚é–“ / D: æ¼”å‡ºé‡è¦–
 * ãƒã‚¤ãƒŠã‚¹å´ï¼š
 * A: ä»²é–“ / B: ãƒ‘ãƒƒã‚·ãƒ§ãƒ³ / C: é•·æ™‚é–“ / D: ç´ ã®ã¾ã¾é‡è¦–
 */

const resultList = [
  null,

  // â‘ ã€œâ‘¯ï¼ˆã‚ãªãŸã®æœ€æ–°ã®ã‚¿ã‚¤ãƒ—åï¼‹ã‚¢ã‚¤ãƒ†ãƒ åï¼‰
  "æ­¯è»ŠãŒæµ®ã‹ã¶é­”æ³•ã®æ‡ä¸­æ™‚è¨ˆ",
  "å°ã•ãªä¸–ç•ŒãŒå…¥ã£ãŸã‚¹ãƒãƒ¼ãƒ‰ãƒ¼ãƒ ",
  "è‰²ãŒå¤‰ã‚ã‚‹ã‚¤ãƒ³ã‚¯ã®ç¾½ãƒšãƒ³",
  "ä»®é¢ãŒæ¬¡ã€…å¤‰ã‚ã‚‹å½¹è€…ã®ãƒã‚¹ã‚¯",

  "ãƒã‚¯ã‚¿ã‚¯é³´ã‚‹é€²è¡Œãƒ™ãƒ«",
  "å°ã•ãªãƒ‰ãƒ©ã‚´ãƒ³ã®ä¼ä»¤ãƒ›ã‚¤ãƒƒã‚¹ãƒ«",
  "ç¬‘é¡”ãŒé£›ã³å‡ºã™ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚¯ãƒ©ãƒƒã‚«ãƒ¼é­”æ³•",
  "å…‰ã‚‹ãŠç¥­ã‚Šãƒªã‚¹ãƒˆãƒãƒ³ãƒ‰ã®è…•è¼ª",

  "ã‚«ãƒã‚«ãƒå‹•ãæ€è€ƒæ­¯è»Šã‚ªãƒ¼ãƒ–",
  "æ–‡å­—ãŒå‹æ‰‹ã«å¢—ãˆã‚‹æ€è€ƒãƒãƒ¼ãƒˆ",
  "ã½ã‹ã½ã‹æ„Ÿæƒ…ãƒ©ãƒ³ã‚¿ãƒ³",
  "ã‚¹ã‚¿ãƒ³ãƒ—ãŒå‹æ‰‹ã«å¢—ãˆã‚‹å†’é™ºãƒ‘ã‚¹ãƒãƒ¼ãƒˆ",

  "ãŠã—ãˆã‚‹æ°´æ™¶ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ",
  "ãƒ”ãƒ³ãŒå‹æ‰‹ã«å‹•ãä¼šè­°ãƒœãƒ¼ãƒ‰",
  "ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã§è‰²ãŒå¤‰ã‚ã‚‹ãŠã—ã‚ƒã¹ã‚Šãƒã‚¤ã‚¯",
  "ã¿ã‚“ãªã®é£²ã¿ç‰©ãŒæ¸©ã‹ããªã‚‹ãƒãƒƒãƒˆ"
];

const resultKeyMap = {
  "0000": 1,
  "0010": 2,
  "0100": 3,
  "0110": 4,
  "1000": 5,
  "1010": 6,
  "1100": 7,
  "1110": 8,
  "0001": 9,
  "0011": 10,
  "0101": 11,
  "0111": 12,
  "1001": 13,
  "1011": 14,
  "1101": 15,
  "1111": 16
};

let userName = "";
let scores = {A:0, B:0, C:0, D:0};
let current = 0;
let history = [];

const choicesCommon = ["ãã†æ€ã†", "ã©ã¡ã‚‰ã‹ã¨ã„ãˆã°ãã†æ€ã†", "ãã†æ€ã‚ãªã„"];
const choiceScore = [2, 1, -2];

let questions = [
  { axis: "A", text: "é…ä¿¡ã¯ã€ãƒªã‚¹ãƒŠãƒ¼ã®åå¿œã‚ˆã‚Šã‚‚ã€Œè‡ªåˆ†ã®ä¸–ç•Œè¦³ã‚„æµã‚Œã€ã‚’å„ªå…ˆã—ã¦é€²ã‚ãŸã„ã€‚", choices: choicesCommon },
  { axis: "A", text: "ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ‹¾ã†ã‚ˆã‚Šã‚‚ã€è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§è©±ã‚’é€²ã‚ã‚‹ã»ã†ãŒè½ã¡ç€ãã€‚", choices: choicesCommon },
  { axis: "A", text: "é…ä¿¡ã¯ã€Œä¸€ç·’ã«å ´ã‚’ä½œã‚‹ã€ã‚ˆã‚Šã€ã€Œè‡ªåˆ†ã®ä½œã£ãŸã‚‚ã®ã‚’è¦‹ã›ã‚‹ã€æ„Ÿè¦šãŒè¿‘ã„ã€‚", choices: choicesCommon },

  { axis: "B", text: "é…ä¿¡å†…å®¹ã‚’è€ƒãˆã‚‹ã¨ãã¯ã€ã€Œæ§‹æˆã‚„åˆ†ã‹ã‚Šã‚„ã™ã•ã€ã‚’ã¾ãšé‡è¦–ã™ã‚‹ã€‚", choices: choicesCommon },
  { axis: "B", text: "æƒ³å®šå¤–ã®å±•é–‹ãŒèµ·ããŸã¨ãã¯ã€ãƒãƒªã§çªã£è¾¼ã‚€ã‚ˆã‚ŠçŠ¶æ³ã‚’æ•´ç†ã—ãŸããªã‚‹ã€‚", choices: choicesCommon },
  { axis: "B", text: "é…ä¿¡ã®æº–å‚™ã§ã¯ã€ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚ˆã‚Šã‚‚ã€Œæµã‚Œã‚„æ§‹æˆã€ã‚’è€ƒãˆã‚‹æ™‚é–“ã®ã»ã†ãŒæ¥½ã—ã„ã€‚", choices: choicesCommon },

  { axis: "C", text: "é…ä¿¡ã¯ã€é•·ãç¶šã‘ã‚‹ã‚ˆã‚Šã‚‚ã€ŒçŸ­ãã¦ã‚‚æ¿ƒã„å†…å®¹ã€ã§çµ‚ã‚ã‚‰ã›ãŸã„ã€‚", choices: choicesCommon },
  { axis: "C", text: "ã€Œæ°—ã¥ã„ãŸã‚‰ä½•æ™‚é–“ã‚‚é…ä¿¡ã—ã¦ã„ãŸã€ã¨ã„ã†çŠ¶æ…‹ã¯ã€ã‚ã‚Šã¨ç†æƒ³ã«è¿‘ã„ã€‚", choices: choicesCommon },
  { axis: "C", text: "é…ä¿¡ã¯ã€ã ã„ãŸã„äºˆå®šã—ã¦ã„ãŸã¨ã“ã‚ã§åŒºåˆ‡ã£ã¦çµ‚ã‚ã‚‹ã“ã¨ãŒå¤šã„ã€‚", choices: choicesCommon },

  { axis: "D", text: "VTuberã¨ã—ã¦ã€ã‚­ãƒ£ãƒ©è¨­å®šã‚„ä¸–ç•Œè¦³ã¯ã—ã£ã‹ã‚Šä½œã‚Šè¾¼ã¿ãŸã„ã¨æ€ã†ã€‚", choices: choicesCommon },
  { axis: "D", text: "é…ä¿¡ä¸­ã¯ã€ã€Œæ™®æ®µã®è‡ªåˆ†ãã®ã¾ã¾ã€ã‚ˆã‚Šã‚‚ã€ã‚­ãƒ£ãƒ©ã‚„ä¸–ç•Œè¦³ã‚’æ„è­˜ã—ãŸæŒ¯ã‚‹èˆã„ã«ãªã‚‹ã“ã¨ãŒå¤šã„ã€‚", choices: choicesCommon },
  { axis: "D", text: "ã€Œã„ã„é…ä¿¡ã ã£ãŸã€ã¨æ„Ÿã˜ã‚‹ã®ã¯ã€ä½œå“ã¨ã—ã¦ã®å®Œæˆåº¦ãŒé«˜ã‹ã£ãŸã¨ãã ã€‚", choices: choicesCommon }
];

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

function startDiagnosis(){
  userName = document.getElementById("nameInput").value.trim();
  shuffle(questions);
  scores = {A:0, B:0, C:0, D:0};
  current = 0;
  history = [];

  document.getElementById("inputArea").style.display="none";
  document.getElementById("resultArea").style.display="none";
  document.getElementById("diagnosisArea").style.display="block";

  showQuestion();
}

function showQuestion(){
  const q = questions[current];
  document.getElementById("question").textContent = `Q${current+1}. ${q.text}`;
  document.getElementById("progress").textContent =
    `é€²è¡ŒçŠ¶æ³ï¼š${current+1} / ${questions.length}`;

  const buttons = document.getElementById("buttons");
  buttons.innerHTML="";

  q.choices.forEach((c,i)=>{
    const b=document.createElement("button");
    b.textContent=c;
    b.onclick=()=>answer(choiceScore[i]);
    buttons.appendChild(b);
  });
}

function answer(v){
  const a = questions[current].axis;
  history.push({a, v});
  scores[a] += v;

  current++;
  current < questions.length ? showQuestion() : showResult(calcResult());
}

function goBack(){
  if(current === 0){
    document.getElementById("diagnosisArea").style.display = "none";
    document.getElementById("inputArea").style.display = "block";
    return;
  }
  current--;
  const h = history.pop();
  scores[h.a] -= h.v;
  showQuestion();
}

function calcResult(){
  let key="";
  ["A","B","C","D"].forEach(a=>{
    key += scores[a] >= 0 ? "0" : "1";
  });
  return resultKeyMap[key];
}

function showResult(num){
  document.getElementById("diagnosisArea").style.display="none";
  document.getElementById("resultArea").style.display="block";

  document.getElementById("result").textContent =
    userName ? `${userName}ã•ã‚“ã®è¨ºæ–­çµæœã¯` : "ã‚ãªãŸã®è¨ºæ–­çµæœã¯";

  document.getElementById("resultImage").innerHTML =
    `<img src="images/${num}.png" alt="è¨ºæ–­çµæœç”»åƒ" style="width:100%;max-width:600px;margin-top:24px;">`;

  const title = userName ? `${userName}ã•ã‚“ã®è¨ºæ–­çµæœ` : "ã‚ãªãŸã®è¨ºæ–­çµæœ";
  const resultText = resultList[num];

  const tweetText =
`${title}ã¯
ã€Œ${resultText}ã€
ã§ã—ãŸğŸ©µâœ¨

ã‚ãªãŸã¯ä½•ãŒå‡ºã‚‹ï¼Ÿ

#VTuberã‚¿ã‚¤ãƒ—è¨ºæ–­ #NyanProLab`;

  document.getElementById("shareBtn").onclick = ()=>{
    window.open(
      "https://twitter.com/intent/tweet?text=" + encodeURIComponent(tweetText),
      "_blank"
    );
  };
}
</script>

</body>
</html>
