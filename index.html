<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>VTuberタイプ診断</title>
<style>
body {
  font-family: sans-serif;
  text-align: center;
  padding: clamp(16px, 5vw, 40px);
  font-size: clamp(14px, 3.5vw, 16px);
}
button {
  padding: 10px 16px;
  margin: 6px;
  font-size: clamp(13px, 3.5vw, 15px);
  min-width: 220px;
  cursor: pointer;
}
#question {
  font-size: clamp(16px, 4.5vw, 20px);
  margin-bottom: 20px;
}
#result {
  font-size: clamp(18px, 5vw, 22px);
  font-weight: bold;
  margin-top: 20px;
}
.switches {
  position: fixed;
  top: 10px;
  right: 10px;
  border: 1px solid #ccc;
  padding: 10px;
  background: #f9f9f9;
  font-size: clamp(11px, 3vw, 12px);
}
</style>
</head>
<body>

<h1>VTuberタイプ診断</h1>

<div id="inputArea">
  <p>
    活動名（必須）<br>
    <input id="nameInput">
  </p>

  <p>
    SNS（任意）<br>
    <input id="snsInput">
  </p>

  <button onclick="startDiagnosis()">診断スタート</button>
</div>

<div id="diagnosisArea" style="display:none;">
  <div id="question"></div>
  <div id="buttons"></div>
  <button onclick="goBack()">← 戻る</button>
</div>

<div id="resultArea" style="display:none;">
  <div id="result"></div>
  <div id="resultImage"></div>
  <button id="shareBtn">Xで共有</button><br>
  <button onclick="restart()">もう一度診断</button>
</div>

<script>
/* =====================
   定数・変数
===================== */
const resultList = [
  null,
  "みんなを連れていく冒険地図",
  "止まらないおしゃべりリップ",
  "ノリで撃つスピードガン",
  "一瞬で沸かすド派手クラッカー",
  "安定運用の砂時計",
  "話題無限の地球儀",
  "完璧主義のチェック腕時計",
  "思い出を挟む押し花の栞",
  "芯のある万年筆",
  "夢見がちなキラキラ万華鏡",
  "正直一直線の王道ソード",
  "かまってほしいうさ耳",
  "世界を組み立てる台本ノート",
  "夜にひらく日記帳",
  "冷静沈着の真面目さん知性メガネ",
  "ことばが透ける繊細ガラスペン"
];

const resultKeyMap = {
  "0000":1,"0001":2,"0010":3,"0011":4,
  "0100":5,"0101":6,"0110":7,"0111":8,
  "1000":9,"1001":10,"1010":11,"1011":12,
  "1100":13,"1101":14,"1110":15,"1111":16
};

let userName = "";
let userSNS = "";
let scores = {A:0,B:0,C:0,D:0};
let current = 0;
let history = [];

const questions = [
 { axis: "A", text: "配信の理想は？", choices: ["一人で黙々やる", "どちらでも", "誰かと一緒にやる"] },
 { axis: "A", text: "トラブルが起きたとき、どうする？", choices: ["まず一人で考える", "場合による", "すぐ誰かに相談"] },
 { axis: "A", text: "コラボ配信についてどう思う？", choices: ["正直あまり得意じゃない", "どちらとも言えない", "大好き／積極的"] },

 { axis: "B", text: "配信内容を決めるときは？", choices: ["数字や反応を重視", "半々くらい", "気分やノリ"] },
 { axis: "B", text: "配信後、アーカイブやデータを見る？", choices: ["かなり細かく見る", "たまに見る", "ほとんど見ない"] },
 { axis: "B", text: "伸びる配信に必要だと思うのは？", choices: ["分析と改善", "両方大事", "勢いと熱量"] },

 { axis: "C", text: "理想の配信時間は？", choices: ["1時間前後", "2〜3時間", "気づいたら長時間"] }, 
 { axis: "C", text: "配信中の集中力は？", choices: ["短期集中型", "波がある", "長く続く"] }, 
 { axis: "C", text: "ゲームや作業にハマると？", choices: ["すぐ飽きる", "ものによる", "何時間もやる"] },

 { axis: "D", text: "配信準備はどれくらいする？", choices: ["ほぼノープラン", "最低限", "しっかり"] }, 
 { axis: "D", text: "スケジュール管理は？", choices: ["ゆるめ", "普通", "きっちり"] }, 
 { axis: "D", text: "台本や進行表について", choices: ["あまり使わない", "あると安心", "必須"] }
];

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

function startDiagnosis(){
  userName = document.getElementById("nameInput").value.trim();
  userSNS  = document.getElementById("snsInput").value.trim();
  if(!userName){ alert("活動名を入力してね"); return; }
  shuffle(questions);
  document.getElementById("inputArea").style.display="none";
  document.getElementById("diagnosisArea").style.display="block";
  showQuestion();
}

function showQuestion(){
  const q = questions[current];
  document.getElementById("question").textContent = `Q${current+1}. ${q.text}`;
  const buttons = document.getElementById("buttons");
  buttons.innerHTML="";
  q.choices.forEach((c,i)=>{
    const b=document.createElement("button");
    b.textContent=c;
    b.onclick=()=>answer(i-1);
    buttons.appendChild(b);
  });
}

function answer(v){
  const a=questions[current].axis;
  history.push({a,v});
  scores[a]+=v;
  current++;
  current<questions.length ? showQuestion() : showResult(calcResult());
}

function goBack(){
  if(current===0)return;
  current--;
  const h=history.pop();
  scores[h.a]-=h.v;
  showQuestion();
}

function calcResult(){
  let key="";
  ["A","B","C","D"].forEach(a=>{
    key+=scores[a]>=0?"0":"1";
  });
  return resultKeyMap[key];
}

function showResult(num){
  document.getElementById("diagnosisArea").style.display="none";
  document.getElementById("resultArea").style.display="block";

  document.getElementById("result").textContent =
    `${userName}さんの診断結果：${resultList[num]}`;

  document.getElementById("resultImage").innerHTML =
    `<img src="images/${num}.png" alt="診断結果画像" style="max-width:450px;margin-top:20px;">`;

  const tweetText =
    `${userName}さんの配信スタイルに最適なアイテムは「${resultList[num]}」でした✨
あなたは何が出る？

#VTuberタイプ診断 #NyanProLab`;

  document.getElementById("shareBtn").onclick = ()=>{
    window.open(
      "https://twitter.com/intent/tweet?text=" +
      encodeURIComponent(tweetText),
      "_blank"
    );
  };
}

function restart(){
  scores={A:0,B:0,C:0,D:0};
  current=0; history=[];
  document.getElementById("resultArea").style.display="none";
  document.getElementById("inputArea").style.display="block";
}
</script>

</body>
</html>
